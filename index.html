<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Signature</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f9;
        }

        .container {
            text-align: center;
        }

        /* Menyesuaikan ukuran canvas dengan lebar dan tinggi layar ponsel */
        canvas {
            border: 2px solid #000;
            background-color: white;
            margin-bottom: 10px;
            width: 90vw;  /* 90% dari lebar layar */
            height: 40vh;  /* 40% dari tinggi layar */
            max-width: 600px;  /* Maksimal lebar canvas */
            max-height: 300px; /* Maksimal tinggi canvas */
        }

        .controls {
            margin-top: 10px;
        }

        .controls select, .controls button {
            padding: 5px 10px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
        }

        .btn-clear {
            background-color: #ff4747;
            color: white;
            border: none;
        }

        .btn-save {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: not-allowed;
        }

        .btn-save.enabled {
            cursor: pointer;
        }

        #message {
            margin-top: 10px;
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Digital Signature</h1>
    <canvas id="signatureCanvas"></canvas> <!-- Ukuran canvas dinamis -->

    <div class="controls">
        <label for="colorPicker">Pilih Warna:</label>
        <select id="colorPicker">
            <option value="#000000">Hitam</option>
            <option value="#ff0000">Merah</option>
            <option value="#0000ff">Biru</option>
            <option value="#00ff00">Hijau</option>
        </select>

        <button class="btn-clear" onclick="clearCanvas()">Bersihkan</button>
        <button id="saveButton" class="btn-save" onclick="saveSignature()" disabled>Simpan</button>
    </div>
    
    <h2>
    @copyright Imandrifatur 2024
    </h2>

    <div id="message"></div>
</div>

<script>
    // Get the canvas element and context
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    const saveButton = document.getElementById('saveButton');

    // Set the default pen color
    let penColor = document.getElementById('colorPicker').value;

    // Set the drawing flag and initial positions
    let isDrawing = false;
    let lastX = 0;
    let lastY = 0;

    // Function to start drawing
    canvas.addEventListener('mousedown', (e) => {
        isDrawing = true;
        lastX = e.offsetX;
        lastY = e.offsetY;
    });

    // Function to stop drawing
    canvas.addEventListener('mouseup', () => {
        isDrawing = false;
    });

    // Function to draw the signature
    canvas.addEventListener('mousemove', (e) => {
        if (!isDrawing) return;

        const currentX = e.offsetX;
        const currentY = e.offsetY;

        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(currentX, currentY);
        ctx.strokeStyle = penColor;
        ctx.lineWidth = 3;
        ctx.lineCap = 'round';
        ctx.stroke();

        lastX = currentX;
        lastY = currentY;

        enableSaveButton();  // Enable the save button if there's drawing
    });

    // Update pen color based on the selected color
    document.getElementById('colorPicker').addEventListener('change', (e) => {
        penColor = e.target.value;
    });

    // Clear the canvas
    function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        document.getElementById('message').textContent = ''; // Clear any error message
        disableSaveButton();  // Disable save button if canvas is cleared
    }

    // Save the signature as an image
    function saveSignature() {
        const imageData = canvas.toDataURL('image/png');

        // Check if canvas is empty
        if (imageData === "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA..." || canvas.width === 0 || canvas.height === 0) {
            document.getElementById('message').textContent = 'Tanda tangan tidak boleh kosong! Silakan gambar terlebih dahulu.';
            return;
        }

        // Create a link to download the signature
        const link = document.createElement('a');
        link.href = imageData;
        link.download = 'signature.png';
        link.click();
    }

    // Function to enable save button
    function enableSaveButton() {
        saveButton.disabled = false;
        saveButton.classList.add('enabled');
    }

    // Function to disable save button
    function disableSaveButton() {
        saveButton.disabled = true;
        saveButton.classList.remove('enabled');
    }

    // Dynamically adjust canvas size on window resize
    window.addEventListener('resize', function() {
        canvas.width = window.innerWidth * 0.9;  // 90% of the window width
        canvas.height = window.innerHeight * 0.4; // 40% of the window height
    });

    // Initialize canvas size on load
    canvas.width = window.innerWidth * 0.9;  // 90% of the window width
    canvas.height = window.innerHeight * 0.4; // 40% of the window height
</script>

</body>
</html>
